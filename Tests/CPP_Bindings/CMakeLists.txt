#########################################################
# Unittests on internal classes of the library

SET(TESTNAME "Test_CPP_Bindings")

set(SRCS_UNITTEST
	./Source/AllTests.cpp
	./Source/Attachments.cpp
	./Source/BaseMaterialGroup.cpp
	./Source/ColorGroup.cpp
	./Source/CompositeMaterials.cpp
	./Source/BeamLattice.cpp
	./Source/BeamSets.cpp
	./Source/BuildItems.cpp
	./Source/MeshObject.cpp
	./Source/MetaData.cpp
	./Source/MetaDataGroup.cpp
	./Source/CustomAttribute.cpp
	./Source/Model.cpp
	./Source/MultiProperties.cpp
	./Source/Object.cpp
	./Source/ProgressCallback.cpp
	./Source/Properties.cpp
	./Source/Reader.cpp
	./Source/Slice.cpp
	./Source/SliceStack.cpp
	./Source/Utilities.cpp
	./Source/Writer.cpp
	./Source/TextureProperty.cpp
	./Source/TextureResources.cpp
	./Source/Wrapper.cpp
)

set(CMAKE_CURRENT_BINARY_DIR ${CMAKE_BINARY_DIR})
add_executable(${TESTNAME} ${SRCS_UNITTEST})

set(STARTUPPROJECT ${TESTNAME})

if (WIN32)
	target_compile_options(${TESTNAME} PUBLIC "$<$<CONFIG:DEBUG>:/Od;/Ob0;/sdl;/W3;/WX;/FC;/MTd;/wd4996>")
	target_compile_options(${TESTNAME} PUBLIC "$<$<CONFIG:RELEASE>:/O2;/sdl;/WX;/Oi;/Gy;/FC;/MT;/wd4996>")
endif()

target_include_directories(${TESTNAME} PRIVATE
	${CMAKE_CURRENT_SOURCE_DIR}/Include
	${gtest_SOURCE_DIR}/include
	${CMAKE_CURRENT_BINARY_DIR_AUTOGENERATED}/Bindings/Cpp
	)
target_link_libraries(${TESTNAME} ${PROJECT_NAME} gtest gtest_main)
set_target_properties(${TESTNAME} PROPERTIES RUNTIME_OUTPUT_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/")

add_test(${TESTNAME} ${CMAKE_CURRENT_BINARY_DIR}/${TESTNAME})

set(STARTUPPROJECT ${STARTUPPROJECT} PARENT_SCOPE)

